services:
  # API Gateway
  - type: web
    name: restaurants-api-gateway
    env: docker
    dockerfilePath: ./src/ApiGateway/Dockerfile
    envVars:
      - key: ASPNETCORE_ENVIRONMENT
        value: Production
      - key: ASPNETCORE_URLS
        value: http://+:80
      - key: ConnectionStrings__DefaultConnection
        fromDatabase:
          name: restaurants-db
          property: connectionString

  # Identity Service
  - type: web
    name: restaurants-identity-service
    env: docker
    dockerfilePath: ./src/Services/Identity/Identity.API/Dockerfile
    envVars:
      - key: ASPNETCORE_ENVIRONMENT
        value: Production
      - key: ConnectionStrings__IdentityDb
        fromDatabase:
          name: identity-db
          property: connectionString

  # Product Service
  - type: web
    name: restaurants-product-service
    env: docker
    dockerfilePath: ./src/Services/Product/Product.API/Dockerfile

  # Order Service
  - type: web
    name: restaurants-order-service
    env: docker
    dockerfilePath: ./src/Services/Order/Order.API/Dockerfile

# Databases
databases:
  - name: restaurants-db
    databaseName: restaurantsdb
    user: restaurants_user
